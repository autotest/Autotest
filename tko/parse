#!/usr/bin/python
import os, re, parse, db, sys

topdir = sys.argv[1]
jobs_list = os.listdir(topdir)

jobs = {}
db = db.db()

for j in jobs_list:
	print 'looking for ' + j
	if db.find_job(j):
		continue
	job = parse.parse(os.path.join(topdir, j), 'regression')
	print 'parsed ' + j
	if not job.kernel:
		continue
	print '%s %s %s %s' % (j, job.kernel, job.status, job.reason)
	db.insert_job(j, job)
